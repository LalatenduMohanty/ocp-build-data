arches:
- x86_64

advisories:
  image: 43533
  rpm: 43535
  # security:

branch: rhaos-{MAJOR}.{MINOR}-rhel-7
name: openshift-{MAJOR}.{MINOR}-fastdata
urls:
  brewhub: https://brewhub.engineering.redhat.com/brewhub
  brew_image_host: brew-pulp-docker01.web.prod.ext.phx2.redhat.com:8888
  cgit: http://pkgs.devel.redhat.com/cgit
# Is the `brew_image_host` source a secure endpoint or will
# --insecure=true be required?
insecure_source: true
dist_git_ignore:
  - gating.yaml
non_release:
  images:
  - openshift-enterprise-base
  - atomic-openshift-metrics-server-container
  - atomic-openshift-cluster-autoscaler-container
  - openshift-enterprise-autoheal
  - cluster-nfd-operator
  - csi-provisioner
  - efs-provisioner
  - ose-haproxy-router-base
  - ose-manila-provisioner
  - snapshot-controller
  - snapshot-provisioner
  - openshift-enterprise-service-idler
  rpms:
  - atomic-openshift-service-idler
  - atomic-openshift-metrics-server-container
  - atomic-openshift-cluster-autoscaler-container
push:
  registries:
  - registry.reg-aws.openshift.com:443
sources:
  ose:
    url: git@github.com:openshift/ose.git
    branch:
      target: enterprise-{MAJOR}.{MINOR}
      fallback: master
# use_source_fallback_branch: always
repos:
  rhel-fast-datapath-rpms:
    conf:
      baseurl:
          x86_64: http://pulp.dist.prod.ext.phx2.redhat.com/content/dist/rhel/server/7/7Server/x86_64/fast-datapath/os/
    content_set:
      default: rhel-7-fast-datapath-rpms
vars:
  MAJOR: 4
  MINOR: 2
default_image_build_method: imagebuilder
image_build_log_scanner:
  matches:
    # yum failed to install a package (but may not give an error result)
  - "No package .* available"
    # dnf failed to find a package to install:
  - "Error: Unable to find a match"
    # on multiarch builds, installed different NVR of pkg for different arches:
  - "Failed component comparison for components:.*"
    # docker does not understand multi-stage builds
  - "is not a valid repository/tag: invalid reference format"
    # indicative of https://github.com/openshift/imagebuilder/issues/87 or file(s) missing
  - "plugins.imagebuilder.*lstat.*no such file or directory"
    # koji sucks at auto-incrementing releases
  - "bump_release: BuildError.'Unable to increment release value:"
    # need to add the image component to whitelist building into candidate tag
  - "not in list for tag rhaos-.*-candidate"
  files:
  - x86_64.log
  - ppc64le.log
  - task_failed.log
  - orchestrator.log
scan_freshness:
  release_regex: '(?x) ^ (\d\d\d\d) (\d\d) (\d\d) (\d\d)'
  threshold_hours: 24
csv_namespace: openshift
